{% extends 'main/base.html' %}

{% block title %}Student Payment Status{% endblock %}

{% block content %}
<div class="row">
    <div class="col-md-12">
        <h3>Student Payment Status</h3>
        
        <!-- Search Form -->
        <form method="GET" action="{% url 'student_payment_status' %}">
            <input type="text" name="q" placeholder="Search by name" value="{{ query }}" class="form-control mb-3">
            <button type="submit" class="btn btn-primary">Search</button>
        </form>

        {% if query %}
            {% if paid_students %}
            <!-- Paid Students Table -->
            <h4>Paid Students</h4>
            <table class="table table-bordered">
                <thead>
                    <tr>
                        <th>First Name</th>
                        <th>Last Name</th>
                        <th>Class</th>
                        <th>Payment Status</th>
                    </tr>
                </thead>
                <tbody>
                    {% for student in paid_students %}
                    <tr>
                        <td>{{ student.first_name }}</td>
                        <td>{{ student.last_name }}</td>
                        <td>{{ student.school_class.level }}{{ student.school_class.section }}</td>
                        <td>{{ student.get_school_fees_status_display }}</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
            {% endif %}

            {% if unpaid_students %}
            <!-- Unpaid Students Table -->
            <h4>Unpaid Students</h4>
            <table class="table table-bordered">
                <thead>
                    <tr>
                        <th>First Name</th>
                        <th>Last Name</th>
                        <th>Class</th>
                        <th>Payment Status</th>
                    </tr>
                </thead>
                <tbody>
                    {% for student in unpaid_students %}
                    <tr>
                        <td>{{ student.first_name }}</td>
                        <td>{{ student.last_name }}</td>
                        <td>{{ student.school_class.level }}{{ student.school_class.section }}</td>
                        <td>{{ student.get_school_fees_status_display }}</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
            {% endif %}

            {% if not paid_students and not unpaid_students %}
            <!-- No Students Found -->
            <p>No students found for the given search criteria.</p>
            {% endif %}
        {% endif %}
    </div>
</div>
{% endblock content %}
